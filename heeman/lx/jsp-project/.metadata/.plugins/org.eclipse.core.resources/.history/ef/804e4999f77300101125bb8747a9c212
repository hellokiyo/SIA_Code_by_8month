package addrbook;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

public class AddrBookDAO {
	static String sql = "select * from employees where DEPARTMENT_ID = ";
	static String driverClassName = "oracle.jdbc.driver.OracleDriver";
	static String connectionUrl = "jdbc:oracle:thin:@localhost:1521:xe";
	static String userName = "hr";
	static String password = "hr";
	static String sqlInsertDB = "insert into addrbook(AB_ID,AB_NAME,ab_email,ab_comdept,ab_birth,ab_tel,ab_memo) "
											+ "values(ab_seq.nextval,?,?,?,?,?,?)";
	static {
		try {
			Class.forName(driverClassName);
		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		}		
	}

	public boolean insertDB(AddrBookVO ab) throws Exception {
		Connection connection = null;
		connection = getConnection();
		PreparedStatement pstmt = connection.prepareStatement(sqlInsertDB);
		boolean result= false;
		try {
			pstmt.setString(1, ab.getAbName());
			//AB_ID,AB_NAME,ab_email,ab_comdept,ab_birth,ab_tel,ab_memo) "
			pstmt.setString(2, ab.getAbEmail());
			pstmt.setString(3, ab.getAbComdept());
			pstmt.setString(4, ab.getAbBirth());
			pstmt.setString(5, ab.getAbTel());
			pstmt.setString(6, ab.getAbMemo());
			result= pstmt.execute();
		} catch (Exception e) {
			e.printStackTrace();
		}
		return result;
	}

	public ArrayList<AddrBookVO> getDBList() throws Exception {
		return null;
	}

	public AddrBookVO getDB(int abId) throws Exception {
		return null;
	}
	public boolean updateDB(AddrBookVO ab) throws Exception {
		return false;
	}
	public boolean deleteDB(int abId) throws Exception {
		return false;
	}
	private static Connection getConnection() throws SQLException {
		return DriverManager.getConnection(connectionUrl, userName, password);
	}
}
